--- openssh-5.3p1/sftp-server.8	2015-02-10 10:08:09.611849984 +0100
+++ openssh-5.3p1/sftp-server.8.perms	2015-02-10 10:08:52.204120509 +0100
@@ -33,6 +33,7 @@ 
 .Op Fl f Ar log_facility
 .Op Fl l Ar log_level
 .Op Fl u Ar umask
+.Op Fl m Ar force_file_perms
 .Sh DESCRIPTION
 .Nm
 is a program that speaks the server side of SFTP protocol
@@ -77,6 +78,10 @@ Sets an explicit
 .Xr umask 2
 to be applied to newly-created files and directories, instead of the
 user's default mask.
+.It Fl m Ar force_file_perms
+Sets explicit file permissions to be applied to newly-created files instead
+of the default or client requested mode.  Numeric values include:
+777, 755, 750, 666, 644, 640, etc.  Option -u is ineffective if -m is set.
 .El
 .Pp
 For logging to work,
--- openssh-5.3p1/sftp-server.c	2015-02-10 10:08:09.611849984 +0100
+++ openssh-5.3p1/sftp-server.c.perms	2015-02-10 10:39:00.855453028 +0100
@@ -70,6 +70,10 @@ Buffer oqueue;
 /* Version of client */
 int version;
 
+/* Force file permissions */
+int permforce = 0;
+long permforcemode;
+
 /* portable attributes, etc. */
 
 typedef struct Stat Stat;
@@ -551,6 +555,10 @@ process_open(void)
 	a = get_attrib();
 	flags = flags_from_portable(pflags);
 	mode = (a->flags & SSH2_FILEXFER_ATTR_PERMISSIONS) ? a->perm : 0666;
+	if (permforce == 1) {   /* Force perm if -m is set */
+		mode = permforcemode;
+		(void)umask(0); /* so umask does not interfere		 */
+	}	
 	logit("open \"%s\" flags %s mode 0%o",
 	    name, string_from_portable(pflags), mode);
 	fd = open(name, flags, mode);
@@ -1322,8 +1330,8 @@ sftp_server_usage(void)
 	extern char *__progname;
 
 	fprintf(stderr,
-	    "usage: %s [-he] [-l log_level] [-f log_facility] [-u umask]\n",
-	    __progname);
+	    "usage: %s [-he] [-l log_level] [-f log_facility] [-u umask]\n"
+	    "          [-m force_file_perms]\n", __progname);
 	exit(1);
 }
 
@@ -1343,7 +1351,7 @@ sftp_server_main(int argc, char **argv,
 	__progname = ssh_get_progname(argv[0]);
 	log_init(__progname, log_level, log_facility, log_stderr);
 
-	while (!skipargs && (ch = getopt(argc, argv, "f:l:u:che")) != -1) {
+	while (!skipargs && (ch = getopt(argc, argv, "f:l:u:m:che")) != -1) {
 		switch (ch) {
 		case 'c':
 			/*
@@ -1373,6 +1381,15 @@ sftp_server_main(int argc, char **argv,
 				fatal("Invalid umask \"%s\"", optarg);
 			(void)umask((mode_t)mask);
 			break;
+		case 'm':
+			/* Force permissions on file received via sftp */
+			permforce = 1;
+			permforcemode = strtol(optarg, &cp, 8);
+			if (permforcemode < 0 || permforcemode > 0777 ||
+			    *cp != '\0' || (permforcemode == 0 &&
+			    errno != 0))
+				fatal("Invalid file mode \"%s\"", optarg);
+			break;
 		case 'h':
 		default:
 			sftp_server_usage();
